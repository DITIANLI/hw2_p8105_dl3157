---
title: "hw2"
author: "Ditian Li"
date: "2018/10/1"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
```

#Problem 1

```{r 11}

nyc_trans = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  gather(key = route, value = route_line,route1:route11) %>%
  separate(route, into = c("x", "route_number"), sep = 5) %>%
  filter(!is.na(route_line)) %>%
  select(line, station_name, station_latitude, station_longitude, route_number,route_line, entry,     vending, entrance_type, ada) %>%
  mutate(entry = ifelse(entry == 'YES',yes = TRUE,no = FALSE)) %>%
  arrange(line,station_name)

```

This dataset contains line, station name, station latitude, station longtitude, entry, vending, entry type, ada, route_name and route_number. We first cleaned variable names, then we used mutate to convert variable type and used gather for route variables. Then dimension is `r nrow(nyc_trans)` by `r ncol(nyc_trans)`. The data is not tidy enough, because we have too many columns to show in one row.

```{r 12}
distinct_stations = nrow(distinct(nyc_trans,station_name,line,.keep_all = TRUE))
ada_compliance = nyc_trans %>%
 filter(ada == TRUE) %>%
 distinct(station_name,line)
 nrow(ada_compliance)

allow_entrance = nyc_trans %>%
 filter(entry == TRUE & vending == 'NO') %>%
 distinct(line,station_name)
 vending = nyc_trans %>%
 filter(vending == 'NO') %>%
 distinct(line,station_name)
 proportion = nrow(allow_entrance)/nrow(vending)
proportion
  
```

```{r 13}
a_train = nyc_trans %>%
 filter(route_line == 'A') %>%
 distinct(station_name,line)
nrow(a_train)
a_ada = nyc_trans %>%
 filter(route_line == 'A' & ada == TRUE) %>%
 distinct(station_name,line)
nrow(a_ada)
```

##Problem 2
```{r 21}
library(readxl)
trash = read_excel(path = './data/HealthyHarborWaterWheelTotals2018-7-28.xlsx',sheet = 'Mr. Trash Wheel',range = cell_cols("A:N")) %>%
janitor::clean_names() %>%
filter(!is.na(date)) %>%
mutate(sports_balls = as.integer(signif(sports_balls)))
```

```{r 22}
library(readxl)
trash_16 = read_excel(path = './data/HealthyHarborWaterWheelTotals2018-7-28.xlsx',sheet = '2016 Precipitation',range = cell_rows(2:14)) %>%
janitor::clean_names() %>%
mutate(year = 2016)

trash_17 = read_excel(path = './data/HealthyHarborWaterWheelTotals2018-7-28.xlsx',sheet = '2017 Precipitation',range = cell_rows(2:10)) %>%
janitor::clean_names() %>%
mutate(year = 2017)

trash_1617 = bind_rows(trash_16,trash_17) %>%
janitor::clean_names() %>%
select(year, everything()) %>%
mutate(month = month.name[month])
```

## Problem 3
```{r 31}
devtools::install_github("p8105/p8105.datasets")
library(p8105.datasets)
brfss_sm = brfss_smart2010 %>%
janitor::clean_names() %>%
separate(locationdesc, into = c("state", "county"), sep = " - ") %>%
filter(topic == 'Overall Health') %>%
select(-class,-topic,-question,-sample_size,-locationabbr,-(confidence_limit_low:geo_location)) %>%
spread(key = response, value = data_value) %>%
janitor::clean_names() %>%
select(year,state,county,excellent,very_good,good,fair,poor) %>%
mutate(above_good = excellent + very_good)


```
