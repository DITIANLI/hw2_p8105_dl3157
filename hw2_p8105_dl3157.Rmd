---
title: "hw2"
author: "Ditian Li"
date: "2018/10/1"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
```

#Problem 1

```{r 11}

nyc_trans = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  gather(key = route, value = route_line,route1:route11) %>%
  separate(route, into = c("x", "route_number"), sep = 5) %>%
  filter(!is.na(route_line)) %>%
  select(line, station_name, station_latitude, station_longitude, route_number,route_line, entry,     vending, entrance_type, ada) %>%
  mutate(entry = ifelse(entry == 'YES',yes = TRUE,no = FALSE)) %>%
  arrange(line,station_name)

```

This dataset contains line, station name, station latitude, station longtitude, entry, vending, entry type, ada, route_name and route_number. We first cleaned variable names, then we used mutate to convert variable type and used gather for route variables. Then dimension is `r nrow(nyc_trans)` by `r ncol(nyc_trans)`. The data is not tidy enough, because we have too many columns to show in one row.

```{r 12}
distinct_stations = nrow(distinct(nyc_trans,station_name,line,.keep_all = TRUE))
ada_compliance = nyc_trans %>%
 filter(ada == TRUE) %>%
 distinct(station_name,line)
 nrow(ada_compliance)

allow_entrance = nyc_trans %>%
 filter(entry == TRUE & vending == 'NO') %>%
 distinct(line,station_name)
 vending = nyc_trans %>%
 filter(vending == 'NO') %>%
 distinct(line,station_name)
 proportion = nrow(allow_entrance)/nrow(vending)
proportion
  
```

```{r 13}
a_train = nyc_trans %>%
 filter(route_name == 'A') %>%
 distinct(station_name,line)
nrow(a_train)

a_ada = nyc_trans %>%
 filter(route_name == 'A' & ada == TRUE) %>%
 distinct(station_name,line)
nrow(a_ada)
```

##Problem 2
```{r 21}
p2_trash = read_excel(path = './data/HealthyHarborWaterWheelTotals2017-9-26.xlsx',sheet = 'Mr. Trash Wheel',range = cell_cols("A:N"))%>%
janitor::clean_names()%>%
filter(!is.na(date))%>%
mutate(sports_balls=as.integer(signif(sports_balls)))
```